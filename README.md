# ML_HW1

Была сделана домашняя работа по анализу данных по датасету, содержащему информацию по продажам автомобилей, обучена модель линейной регрессии для предсказания стоимости автомобилей, а также реализован ввеб-сервис для применения построенной модели на новых данных. 
Набор данных:
Исходный набор данных содержит информацию о таких характеристиках автомобилей, как год продажи, цена продажи, название модели автомобиля, пробег, тип продавца (индивидуальный продавец, дилер и т. д.), топливо (дизель, бензин и т. д.), тип коробки передач (механика, автомат), количество сидений, хозяин автомобиля (первый по счету, второй и т. д.), мощность двигателя, крутящий момент двигателя. 
Предварительная обработка данных: 
Были получены и проанализированы описательные статистики по числовым и категориальным признакам. Выявлено наличие пропусков в данных - по признакам mileage, engine, max_power, torque, seats. Также из тренировочного набор данных были исключены полные дубликаты (для каждого повторяющегося набора признаков оставлены объекты с максимальной ценой продажи). Признаки mileage, engine, max_power в целях дальнейшего анализа и обучения модели были привдены к числовому формату, что позволило заполнить пропуски в тренировочном и тестовом наборе данных по этим признаком медианным значениям по тренировочному набору данных. Признак torque (крутящий момент двигателя) исключен из набора данных ввиду нечитаемой формы его значений и их невозможности использования в модели.  
Визуализация данных: 
Были построены визулизации попарных распределений всех признаков между собой, а также с целевой переменной - стоимостью автомобиля на тренировочных и тестовых данных (графики получились довольно похожи по отображаемым на них зависимостям). При анализе попарных распределений сделаны следующие выводы: целевая переменная selling price исходя из анализа графиков отрицательно зависит от km_driven, показывает некоторую положительную зависимость от года year и от мощности двигателя max_power. Также на графиках можно разглядеть некоторую отрицательную зависимость от mileage. Зависимость ни в каком из случаев не похожа на линейную, есть некоторые сходства с квадратичной зависимостью. Что касается корреляций признаков, можно заметить зависимость, похожую на линейную, между признаками engine и max_power (положительная связь), engine и mileage (отрицательная связь), частично - mileage и max_power (отрицательная связь). 
Также была построена корреляционная матрица признаков. Самыми скоррелированными признаки оказались year и engine. Довольно сильная положительная зависимость наблюдалась между Selling_price и max_power, engine и max_power, seats и engine. То есть, согласно коэффициенту корреляции, целевая переменная больше всего зависит от признака мощности двигателя. 
Построены также диаграммы рассеяния для таргета (цены) и трех основных признаков, от которых он зависит, исходя из значений коэффициента корреляции (0.69 для max_power, 0.45 и 0.43 для year и engine соответственно). Таким образом, можно сказать что наша целевая переменная положительно (и линейно) зависит от данных трех признаков.
Построение модели: 
Далее была построена регресионная модель классической линейной регрессии на числовых признаках ("year", "km_driven", "mileage", "engine", "max_power", "seats") с дефолтными параметрами. R2 для теста составил 0.59. После была произведена стандартизация признаков с использованием Standard Scaler и заново оценена регресионная омдель, однако метрики качества модели (R2 и MSE) практически не изменились. Самым информативным в предсказании цены автомобиля оказался признак max_power - самое большое абсолютное значение коэффициента регресионной модели.
Далее были сделаны попытки улучшить модель с помощью регуляризации - Lasso и Elastic Net, сначала с использованием гиперпараметров по умолчанию, а потом - подобранных с помощью GridSearchCV на 10 фолдах. Что касается Lasso регрессии, L1-регуляризация с параметрами по умолчанию не занулила веса признаков. Возможно дело в том, что параметр alpha по умолчанию слишком мал (а коэффициенты большие), т. е. данный метод регуляризации недостаточно штрафует модель. Тем не менее, исходя из метрик качества, модель значительно улучшить посредством регуляризации не удалось. 
На следующем этапе в модель был добавлены категориальные признаки, полученные методом (One Hot Encoding): 'fuel','seller_type', 'transmission', 'owner'. На новом наборе данных была оценена классическая линейная модель, а также Ridge регрессия (с гиперпараметрами, подобранными с помощью GridSearch CV). Удалось немного увеличить качества предсказания (R2 = 0.60), и выбрана для дальнейшей работы классическая линейная модель.
Для еще большего улучшения модели были сгенерированы новые признаки:  число "лошадей" на литр объема, а также квадрат года - зависимость цены от года выглядит квадратичной, а не линейной. Новый набор данных также был стандартизирован, добавлены категориальные признаки. Метрики качества повысились, R2 для теста: 0.63 - данная модель выбрана лучшей и реализована в вэб-сервисе. 
Что не получилось:
Несмотря на довольно высокие метрики качества, рассчитанная бизнес-метрика (среди всех предсказанных цен на авто посчитать доля предиктов, отличающихся от реальных цен на эти авто не более чем на 10% (в одну или другую сторону)) оказалась очень невысокой (21%) - для выяснения причин требуются дополнительные исследования. 


Скрин-шоты вэб-сервиса: 
![image](https://github.com/LyubovGuzhvina/ML_HW1/assets/147088872/907e2cd1-46a7-4207-b5c2-41e169dd0c4c)
![image](https://github.com/LyubovGuzhvina/ML_HW1/assets/147088872/9804bb3e-eb28-42f2-813e-4f4c86692a23)
![image](https://github.com/LyubovGuzhvina/ML_HW1/assets/147088872/1fa61305-cf28-420b-9947-b320e0b39da2)
![image](https://github.com/LyubovGuzhvina/ML_HW1/assets/147088872/24a1ba02-40c4-4161-82d0-f9608291e9b0)
![image](https://github.com/LyubovGuzhvina/ML_HW1/assets/147088872/aeb3c3d6-b330-4d48-8a02-6a9e5cb13462)


